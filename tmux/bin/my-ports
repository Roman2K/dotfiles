#!/usr/bin/env bash

ROOT_DIR=$(dirname "$0")/..

. "$ROOT_DIR"/utils.sh

PORTS_REGEXP=$(cat "$ROOT_DIR"/conf/my-ports)

[[ "$PORTS_REGEXP" ]] || exit 1

lsof -l -P -n -iTCP -sTCP:LISTEN \
  | sed -E '1d; s/.*:([0-9]+) \(LISTEN\).*/\1/' \
  | egrep "\b$PORTS_REGEXP\b" \
  | sort -n \
  | uniq \
  | join_str ", "
